npm run --no-install prettier:check
npm run --no-install lint:sol

# Checks that the crate's version and ABI files are up-to-date.
printf "> python3 httpz_gateway_rust_bindings/abi_update.py check\n\n"
python3 httpz_gateway_rust_bindings/abi_update.py check

# Checks that the contract selectors are up-to-date.
printf "> forge selectors list | tail -n +2 | diff ./docs/contract_selectors.txt -\n\n"
if ! forge selectors list | tail -n +2 | diff ./docs/contract_selectors.txt - &> /dev/null; then
    printf "\033[91m\033[1m[-]\033[0m Contract selectors are not up-to-date.\n" >&2
    printf "Please run 'make update-selectors' to update them.\n\n" >&2
    exit 1
fi

# Checks the formatting of the crate's code.
printf "> cd httpz_gateway_rust_bindings && cargo fmt --check && cd ..\n\n"
cd httpz_gateway_rust_bindings && cargo fmt --check && cd ..

# Lints the crate's code.
printf "> cd httpz_gateway_rust_bindings && cargo clippy -- -D warnings && cd ..\n\n"
cd httpz_gateway_rust_bindings && cargo clippy -- -D warnings && cd ..
